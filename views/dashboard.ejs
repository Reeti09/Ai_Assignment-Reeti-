<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salesforce AI | Prep Assistant</title>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <style>
        /* Custom Salesforce Blue styling for list markers */
        .prose ul li::marker { color: #00A1E0; }
        .prose h3 { color: #1e293b; margin-top: 1.5rem; margin-bottom: 0.5rem; font-weight: 700; }

        /* Print-specific styling to hide UI elements and clean up PDF */
        @media print {
            .no-print { display: none !important; }
            body { background: white; }
            .container { max-width: 100%; width: 100%; padding: 0; margin: 0; }
            article { border: none !important; box-shadow: none !important; page-break-after: always; }
            nav, footer { display: none !important; }
        }
    </style>
</head>
<body class="bg-slate-50 font-sans text-slate-900">
    <nav class="bg-[#00A1E0] p-4 shadow-lg text-white no-print">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <span class="text-2xl">ðŸ¤–</span>
                <h1 class="text-xl font-bold tracking-tight">Salesforce Prep Buddy</h1>
            </div>
            <div class="flex items-center gap-4">
                <span class="hidden md:block text-sm opacity-90">Today: <%= new Date().toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' }) %></span>
                <button onclick="window.location.reload()" class="bg-white/20 hover:bg-white/30 px-3 py-1 rounded text-sm transition">Refresh Sync</button>
            </div>
        </div>
    </nav>

    <main class="container mx-auto py-8 px-4 max-w-5xl">
        <div class="flex justify-between items-center mb-8 pb-4 border-b-2 border-slate-200">
            <h2 class="text-3xl font-extrabold text-slate-800">Your Briefings</h2>
            <button onclick="window.print()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg shadow-md transition flex items-center gap-2 no-print">
                <span>ðŸ“„</span> Export to PDF
            </button>
        </div>

        <div class="grid gap-8">
            <% if (meetings.length === 0) { %>
                <div class="bg-white p-12 text-center rounded-2xl shadow-sm border-2 border-dashed border-slate-200">
                    <div class="text-5xl mb-4">â˜•</div>
                    <h3 class="text-xl font-bold text-slate-700">All Clear!</h3>
                    <p class="text-slate-500 mt-2">No external meetings found on your calendar for today.</p>
                </div>
            <% } %>

            <% meetings.forEach(meeting => { %>
                <article class="bg-white rounded-xl shadow-md border border-slate-200 overflow-hidden mb-10 transition-all hover:shadow-lg">
                    <div class="h-2 bg-[#00A1E0]"></div>
                    
                    <div class="p-8">
                        <div class="flex justify-between items-start mb-6 pb-6 border-b border-slate-100">
                            <div>
                                <span class="bg-blue-100 text-blue-700 text-xs font-bold px-2 py-0.5 rounded uppercase tracking-widest mr-2 no-print">Live Sync</span>
                                <span class="text-slate-500 font-bold tracking-tight"><%= meeting.time %></span>
                                <h4 class="text-sm text-slate-400 mt-1 uppercase font-semibold">Calendar Event: <%= meeting.summary %></h4>
                            </div>
                            <div class="text-right">
                                <p class="text-xs font-medium text-slate-400 uppercase">Contact Email</p>
                                <p class="text-slate-700 font-mono text-sm bg-slate-50 px-2 py-1 rounded border border-slate-100 inline-block"><%= meeting.email %></p>
                            </div>
                        </div>

                        <div class="prose prose-slate max-w-none 
                                    prose-h3:text-2xl prose-h3:font-black prose-h3:text-slate-800 prose-h3:mt-8 prose-h3:mb-4
                                    prose-li:text-slate-600 prose-li:mb-3 prose-li:leading-relaxed
                                    prose-strong:text-slate-900 prose-strong:font-bold
                                    prose-p:text-slate-700 prose-p:text-lg prose-p:leading-relaxed">
                            
                            <%- meeting.prepHtml %>
                            
                        </div>
                    </div>

                    <div class="px-8 py-4 bg-slate-50 border-t border-slate-100 flex justify-between items-center no-print">
                        <div class="flex gap-3">
                            <button onclick="speakBriefing('prep-<%= meeting.company %>')" 
                                    class="flex items-center gap-2 bg-white border border-slate-200 text-slate-600 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-slate-100 transition shadow-sm">
                                ðŸ”Š Play Audio Brief
                            </button>

                            <button onclick="simulateSlack()" 
                                    class="flex items-center gap-2 bg-[#4A154B] text-white px-3 py-1.5 rounded-lg text-xs font-bold hover:opacity-90 transition shadow-sm">
                                <span class="text-[14px]">#</span> Push to Slack
                            </button>
                        </div>

                        <div class="flex items-center gap-2">
                             <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                             <span class="text-[10px] text-slate-500 font-bold uppercase tracking-widest">AI Agent Analysis Complete</span>
                        </div>
                    </div>

                    <div id="prep-<%= meeting.company %>" class="hidden">
                        <%= meeting.prepHtml.replace(/<[^>]*>?/gm, '') %> 
                    </div>
                </article>
            <% }) %>
        </div>
    </main>

    <footer class="mt-12 py-8 text-center text-slate-400 text-sm border-t border-slate-200 no-print">
        Made by Reeti &bull; 2026
    </footer>

    <script>
        function speakBriefing(contentId) {
            const text = document.getElementById(contentId).innerText;
            
            // Stop any current speech
            window.speechSynthesis.cancel();

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 0.95; // Natural pace
            utterance.pitch = 1.0;
            
            // Pick a professional sounding voice if available
            const voices = window.speechSynthesis.getVoices();
            const preferredVoice = voices.find(v => v.name.includes('Google US English') || v.lang === 'en-US');
            if (preferredVoice) utterance.voice = preferredVoice;

            window.speechSynthesis.speak(utterance);
        }

        function simulateSlack() {
            alert("ðŸš€ Integration Demo: This strategic briefing has been pushed to the #sales-intelligence Slack channel!");
            console.log("Slack Webhook triggered: POST https://hooks.slack.com/services/...");
        }
    </script>
</body>
</html>